package com.uddangtangtang.global.util;

import com.uddangtangtang.domain.traveltype.dto.request.TypeRequest;

public class AiTypePromptBuilder {

    public static String buildPromptFromRequest(TypeRequest request) {
        String[] plan = request.answer().split("-");


        return """
너는 여행 성향 분석가야.

사용자의 답변을 보고 아래 3가지 축에 따라 여행 성향을 판단하라:
- 계획성(P), 에너지 방향(E), 소비 성향(C)

각 문항마다 선택지에 따라 점수가 다르며, 선택된 값에 해당하는 점수를 누적해 최종 결과를 판단하라.

[문항별 점수표 및 사용자 선택]
(1) 계획성
Q1. 비행기 표가 갑자기 생겼다!
- 선택: %s (A: 1점 / B: 1점)
Q2. 가려던 식당이 닫혀 있다면?!
- 선택: %s (A: 1점 / B: 1점)
Q3. 자유여행을 가게 된다면? (우선순위)
- 선택: %s (A: 2점 / B: 2점)
Q4. 여행 전날, 짐 싸면서 드는 생각은?
- 선택: %s (A: 1점 / B: 1점)


(2) 에너지 방향
Q1. 여행 준비 시간! 당신은?
- 선택: %s (A: 1점 / B: 1점)
Q2. 낯선 여행지에서의 저녁!
- 선택: %s (A: 1점 / B: 1점)
Q3. 여행지에서 우연히 만난 사람과 대화가 시작됐다면?(우선순위)
- 선택: %s (A: 1점 / B: 1점)
Q4. 여행 끝나고 느낀 점은?
- 선택: %s (A: 2점 / B: 2점)

(3) 소비 성향
Q1. 숙소 예약할 때 가장 먼저 보는 건?
- 선택: %s (A: 1점 / B: 1점)
Q2. 비슷한 맛집 두 곳이 있다면?
- 선택: %s (A: 1점 / B: 1점)
Q3. 쇼핑 거리를 걷던 중, 예상치 못한 예쁜 소품 발견!
- 선택: %s (A: 1점 / B: 1점)
Q4. 교통수단을 고를 때는?(우선순위)
- 선택: %s (A: 2점 / B: 2점)

[요구사항]
1. 각 축별 A점수와 B점수를 계산하라.
2. 점수가 높은 쪽이 해당 축의 결과이다.
3. 점수가 같으면 우선순위 문항의 선택지를 기준으로 결정하라.
4. 최종적으로 3축 결과를 조합하여 code를 만들고, reason을 작성하라.
5. 반드시 아래 JSON 형식으로만 결과를 출력하라.

        [유형 리스트]
        1.계획충 쉴러 A-B-A (철저한 계획형 + 힐링 지향 / 조용한 쉼과 통제된 일정 선호)
        2.자낳괴 탐험가 B-A-A (무계획 + 외향 + 액티비티/즉흥 중심 / 번아웃을 넘은 ‘번쩍아웃러’)
        3.패키지 러버 A-A-B (계획형 + 감성 지향 / 패키지 코스 + 뷰 맛집 선호)
        4.가성비 장인 B-B-A (자유형 + 내향 + 실속 우선 / ‘지출 관리왕’ + 미니멀 여행자)
        5.감성 도파민러 A-B-B (자유형 + 외향 + 감성 + 충동적 경험 선호 / 즉흥적 힐링러)
        6.단톡방 총무 A-A-A (계획형 + 외향 + 모험지향 / 단톡방 리더 + 일정 컨트롤러)
        7.무념무상 힐링러 B-B-B (무계획 + 내향 + 조용한 쉼 선호 / 일정 없이 느긋한 여행)
        8.온도차 낭만파 B-A-B (자유형 + 감성 + 살짝 외향 + 즉흥적이되 일정 선택형 / 카페, 글쓰기, 감성 여행)

        계획, 에너지, 소비성향 답변의 알파벳을 조합하여 유형리스트와 비교 후 동일한 것을 아래 반환형식 예시와 같이 반환해라
        
        ※ 아래 형식 외에는 어떤 말도 하지 마라. 반드시 이 형식만 그대로 JSON으로 반환해라.
        반드시 아래 JSON 형식만 출력하라. 설명 문장, 개행, 문장부호 등은 절대 포함하지 마라.
        ※또한 예시에서 reason 부분은 예시일 뿐 너가 해당 유형에 맞게 알아서 작성해줘 그리고 JSON 문자열 안에서 줄바꿈(엔터, \\n)을 절대 사용하지 말고, reason은 한 줄로 길게 작성해라.
                                                                            
        [반환형식예시]
        {
         "code": "A-A-B",
         "reason": "할인과 특가, 쿠폰은 절대 못 지나치는 알뜰한 여행 스타일! 여행에서도 철저한 예산 관리와 계획으로 최소의 비용으로 최대의 만족을 추구하는 실속파예요. 소소한 것에서 행복을 찾고, 혼자서도 여행을 즐길 줄 아는 ‘가성비 여행 마스터’!"
        }
        ※ 반환 예시의 reason은 단순 예시이며, 반드시 code에 맞는 새로운 reason을 직접 길게 작성하라. 예시 reason 복사 금지.
        """.formatted(
                plan[1], plan[6], plan[0], plan[4],
                plan[2], plan[10], plan[9], plan[11],
                plan[3], plan[7], plan[8], plan[5]

        );
    }
}
